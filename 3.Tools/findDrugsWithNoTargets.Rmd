---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
KnownTarget_predictions[grep('oxibendazole',KnownTarget_predictions$drugName),]
differentialtargeting=KnownTarget_predictions[which(KnownTarget_predictions$predicted_resistance_mutation),]
differentialtargeting=differentialtargeting[differentialtargeting$PredictedRank<523,]
unique(differentialtargeting[differentialtargeting$mutation_interaction_strength<0,])
unique(differentialtargeting[differentialtargeting$mutation_interaction_strength>0,])
differentialtargeting
```


```{r}
CCLE_mutations=read.csv('/Users/sinhas8/Project_TrueTarget/Data/CCLE_mutations.csv')
CCLE_mutations_matched=CCLE_mutations_matched[CCLE_mutations_matched$Variant_Classification!='Silent',]
CCLE_mutations$variant=paste(CCLE_mutations$Hugo_Symbol, CCLE_mutations$Protein_Change)
head(sort(table(CCLE_mutations$variant)), 20)
where_crispr_drug_also_available=CCLE_mutations$DepMap_ID %in% matched_cellLines
CCLE_mutations_matched=CCLE_mutations[where_crispr_drug_also_available,]
# remove silent
CCLE_mutations_matched=CCLE_mutations_matched[CCLE_mutations_matched$Variant_Classification!='Silent',]
egfr_id=CCLE_mutations_matched$Hugo_Symbol %in% 'DDR2'
sort(table(CCLE_mutations_matched$Protein_Change[egfr_id]), decreasing = T)
```
<!-- no target -->
```{r}
sum(is.na(KnownTarget_predictions$MaxTargetName) & 
      (KnownTarget_predictions$BestTargetCorrFDR)<0.05, na.rm = T)
KnownTarget_predictions_unique=unique(KnownTarget_predictions)
drugCategory_secScreen=onTarget$drugCategory[onTarget$drugCategory$name %in% KnownTarget_predictions_unique$drugName,]
drugCategory_secScreen=unique(drugCategory_secScreen)
#only cancer drugs
drugCategory_secScreen_cancer=drugCategory_secScreen[grep('targeted cancer',drugCategory_secScreen$drug_category),]
#
notargetCancerDrugs=drugCategory_secScreen_cancer[is.na(drugCategory_secScreen_cancer$target),]
notargetCancerDrugs_score=KnownTarget_predictions_unique[which(KnownTarget_predictions_unique$drugName %in% notargetCancerDrugs$name),]
notargetCancerDrugs_score_sigHits=notargetCancerDrugs_score[notargetCancerDrugs_score$BestTargetCorrFDR<0.05,-(2:11)]
finalList_noTargets=notargetCancerDrugs_score_sigHits[order(notargetCancerDrugs_score_sigHits$BestTargetCorr, decreasing = T),]
write.csv(finalList_noTargets, '/Users/sinhas8/Project_TrueTarget/Data/finalList_noTargets.csv')
```

```{r}

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

