---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 
<!-- Integrate binding information into account in our pipeline -->
<!-- Load Binding DB inhibitio-->
```{r}
BindingDB_Inhibition=read.csv('/Users/sinhas8/Project_TrueTarget/Data/BindingDB/BindingDB_BindingDB_Inhibition.tsv', sep='\t')
drugbank_vocabulary=read.csv('/Users/sinhas8/Project_TrueTarget/Data/BindingDB/drugbank vocabulary.csv')
DSSTox_Identifiers_and_CASRN=readxl::read_xlsx('/Users/sinhas8/Project_TrueTarget/Data/BindingDB/DSSTox_Identifiers_and_CASRN.xlsx')
repurposing_drugs=read.csv('/Users/sinhas8/Project_TrueTarget/Data/BindingDB/repurposing_drugs_20180907.txt', sep='\t')
```
<!-- Preprocessing -->
```{r}
repurposing_drugs$pert_iname_stripall=stripall2match(repurposing_drugs$pert_iname)
KnownTarget_predictions$drugName_stripall=stripall2match(KnownTarget_predictions$drugName)
onTarget$drugCategory$name_allstrip=stripall2match(onTarget$drugCategory$name)
drugCandidates_for_secTargets=unique(drugCandidates_for_secTargets)
drugCandidates_for_secTargets$category=onTarget$drugCategory$drug_category[match(drugCandidates_for_secTargets$drugName, onTarget$drugCategory$name)]

BindingDB_Inhibition$common_Name=drugbank_vocabulary$Common.name[
  match(BindingDB_Inhibition$DrugBank.ID.of.Ligand, drugbank_vocabulary$DrugBank.ID)]
```

```{r}
where_id_is_available=union(drugbank_vocabulary$Common.name_allstrip[
  match(stripall2match(drugCandidates_for_secTargets$drugName), drugbank_vocabulary$Common.name_allstrip)
  ], DSSTox_Identifiers_and_CASRN$preferred_name_strilall[
  match(stripall2match(drugCandidates_for_secTargets$drugName),DSSTox_Identifiers_and_CASRN$preferred_name_strilall)])
```
```{r}
drug_for_sec_Target_wdBinding=
  data.frame(drugname=drugCandidates_for_secTargets$drugName_stripall[na.omit(match(stripall2match(BindingDB_Inhibition$common_Name),
                                                              drugCandidates_for_secTargets$drugName_stripall))],
           BindingDB_Inhibition[!is.na(match(stripall2match(BindingDB_Inhibition$common_Name),
                                                              drugCandidates_for_secTargets$drugName_stripall)),])

drug_for_sec_Target_wdBinding_list=split(drug_for_sec_Target_wdBinding, drug_for_sec_Target_wdBinding$drugname)
drug_for_sec_Target_wdBinding_list[[1]]$Target.Name.Assigned.by.Curator.or.DataSource
drugCandidates_for_secTargets
```

```{r}
onTarget$drugCategory[onTarget$drugCategory$name=='palbociclib',]
```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

