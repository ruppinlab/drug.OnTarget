---
title: "Supplementary Figure 10"
output: html_notebook
---

<!-- Supplementary_10B - Pathways enriched in the mechanism of actions of drugs with incorrect targets  -->
<!-- ribociclib: Incorrect and correct Target; Figure S5C -->
```{r}
CurrWrong_Target='CDK4'; DOI='ribociclib'; BestPredicted_Target='CDIPT'
DOI_id=KnownTarget_predictions$drugBroadID[grep(DOI, KnownTarget_predictions$drugName)[1]]
Figure_supp_10BC_data=rbind(data.frame(Target='Currently Known Target',
                               TargetName=CurrWrong_Target,
                               CRISPR_KO=avana_matched[CurrWrong_Target,],
                               drug_response=drug_matched[DOI_id,]),
                    data.frame(Target='Predicted Target',
                               TargetName=BestPredicted_Target,
                               CRISPR_KO=avana_matched[BestPredicted_Target,],
                               drug_response=drug_matched[DOI_id,]
                               )
                    )


Figure_supp_10BC <- ggplot(FigureS5C_data, aes(x=CRISPR_KO, y=drug_response))+
  geom_point()+
  stat_smooth(method = 'lm', se = T)+
  facet_wrap(.~Target+TargetName, scales = 'free')+
  theme_bw(base_size = 12)+
  labs(x='Viability after CRISPR-KO',
       y=paste('Response to', DOI))+
  stat_cor(size=4)+
  theme(legend.position = 'top')
Figure_supp_10BC
```

```{r}
CurrWrong_Target='DNMT1'; DOI='decitabine'; BestPredicted_Target='CFAP20'
DOI_id=KnownTarget_predictions$drugBroadID[grep(DOI, KnownTarget_predictions$drugName)[1]]
Figure_supp_10DE_data=rbind(data.frame(Target='Currently Known Target',
                               TargetName=CurrWrong_Target,
                               CRISPR_KO=avana_matched[CurrWrong_Target,],
                               drug_response=drug_matched[DOI_id,]),
                    data.frame(Target='Predicted Target',
                               TargetName=BestPredicted_Target,
                               CRISPR_KO=avana_matched[BestPredicted_Target,],
                               drug_response=drug_matched[DOI_id,]
                               )
                    )


Figure_supp_10DE<- ggplot(FigureS5D_data, aes(x=CRISPR_KO, y=drug_response))+
  geom_point()+
  stat_smooth(method = 'lm', se = T)+
  facet_wrap(.~Target+TargetName, scales = 'free')+
  theme_bw(base_size = 12)+
  labs(x='Viability after CRISPR-KO',
       y=paste('Response to', DOI))+
  stat_cor(size=4)+
  theme(legend.position = 'top')
Figure_supp_10DE
```

```{r}
Figure_supp_10B <-grid.arrange(FigureS5C, FigureS5D, nrow=1)
ggsave(Figure_supp_10B, filename = '../result/Figure_Supp_10CD.pdf',
       width = 10, height = 4)

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

